# ü§ñ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram Bot –¥–ª—è –ö–µ–π—Å –ú–∞—Å—Ç–µ—Ä–∞

–ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ Telegram Bot –¥–ª—è –≤–∞—à–µ–≥–æ Mini App —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∑–≤–µ–∑–¥–∞–º–∏ –∏ –ø—Ä–∏–∑–∞–º–∏.

## üìã –ß—Ç–æ –≤–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è

1. **Telegram –∞–∫–∫–∞—É–Ω—Ç** (—É–∂–µ –µ—Å—Ç—å)
2. **–•–æ—Å—Ç–∏–Ω–≥** –¥–ª—è —Ñ–∞–π–ª–æ–≤ (GitHub Pages, Netlify, Vercel)
3. **–°–µ—Ä–≤–µ—Ä** –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ API (Node.js, Python, PHP)
4. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** (MongoDB, PostgreSQL, MySQL)

## üöÄ –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ Telegram Bot

### 1.1 –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ @BotFather

1. –û—Ç–∫—Ä–æ–π—Ç–µ Telegram –∏ –Ω–∞–π–¥–∏—Ç–µ [@BotFather](https://t.me/BotFather)
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/newbot`
3. –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –±–æ—Ç–∞: `–ö–µ–π—Å –ú–∞—Å—Ç–µ—Ä`
4. –í–≤–µ–¥–∏—Ç–µ username –±–æ—Ç–∞: `your_case_master_bot` (–¥–æ–ª–∂–µ–Ω –∑–∞–∫–∞–Ω—á–∏–≤–∞—Ç—å—Å—è –Ω–∞ `bot`)
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π **TOKEN** - –æ–Ω –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –¥–ª—è API

### 1.2 –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –±–æ—Ç–∞

```
/setdescription - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ –±–æ—Ç–∞
/setabouttext - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±–æ—Ç–µ
/setuserpic - –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∞–≤–∞—Ç–∞—Ä –±–æ—Ç–∞
/setcommands - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∫–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞
```

**–ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞:**
```
start - –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
help - –ü–æ–º–æ—â—å
balance - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–ª–∞–Ω—Å –∑–≤–µ–∑–¥
inventory - –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
```

## üåê –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ Mini App

### 2.1 –°–æ–∑–¥–∞–π—Ç–µ WebApp

1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/newapp` –≤ @BotFather
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
3. –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: `–ö–µ–π—Å –ú–∞—Å—Ç–µ—Ä`
4. –í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ: `–û—Ç–∫—Ä—ã–≤–∞–π—Ç–µ –∫–µ–π—Å—ã –∑–∞ –∑–≤–µ–∑–¥—ã Telegram!`
5. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø—Ä–µ–≤—å—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (512x512px)
6. –í–≤–µ–¥–∏—Ç–µ URL –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: `https://your-domain.com`

### 2.2 –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–∞–Ω–∏—Ñ–µ—Å—Ç

–û–±–Ω–æ–≤–∏—Ç–µ `manifest.json`:
```json
{
  "telegram": {
    "bot_username": "@your_case_master_bot",
    "webapp_url": "https://your-domain.com"
  }
}
```

## üíª –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

### 3.1 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–µ—Ä–≤–µ—Ä–∞ (Node.js)

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `server.js`:

```javascript
const express = require('express');
const cors = require('cors');
const crypto = require('crypto');

const app = express();
app.use(express.json());
app.use(cors());

const BOT_TOKEN = 'YOUR_BOT_TOKEN';
const WEBHOOK_SECRET = 'YOUR_WEBHOOK_SECRET';

// Middleware –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–∞–Ω–Ω—ã—Ö Telegram
function verifyTelegramData(req, res, next) {
    const { init_data } = req.body;
    if (!init_data) {
        return res.status(400).json({ error: 'Missing init_data' });
    }
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö
    const secret = crypto.createHash('sha256').update(BOT_TOKEN).digest();
    const hash = crypto.createHmac('sha256', secret).update(init_data).digest('hex');
    
    if (hash !== req.headers['x-telegram-hash']) {
        return res.status(401).json({ error: 'Invalid signature' });
    }
    
    next();
}

// –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –∑–≤–µ–∑–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
app.post('/api/user/stars', verifyTelegramData, async (req, res) => {
    try {
        const { user_id } = req.body;
        
        // –ó–¥–µ—Å—å –∑–∞–ø—Ä–æ—Å –∫ Telegram Bot API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ –∑–≤–µ–∑–¥
        const response = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/getUserStars`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ user_id })
        });
        
        const data = await response.json();
        
        res.json({
            stars_balance: data.result?.stars || 0
        });
    } catch (error) {
        res.status(500).json({ error: 'Failed to get stars balance' });
    }
});

// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
app.post('/api/user/save', verifyTelegramData, async (req, res) => {
    try {
        const { user_id, stars_balance, inventory } = req.body;
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
        await saveUserData(user_id, { stars_balance, inventory });
        
        res.json({ success: true });
    } catch (error) {
        res.status(500).json({ error: 'Failed to save user data' });
    }
});

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–∏–∑–∞
app.post('/api/prize/claim', verifyTelegramData, async (req, res) => {
    try {
        const { user_id, prize } = req.body;
        
        let result = { success: true };
        
        switch (prize.type) {
            case 'gift':
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø–æ–¥–∞—Ä–æ–∫ —á–µ—Ä–µ–∑ Telegram
                result.gift_message_id = await sendTelegramGift(user_id, prize);
                break;
                
            case 'premium':
                // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –ø—Ä–µ–º–∏—É–º –ø–æ–¥–ø–∏—Å–∫—É
                result.subscription_id = await activatePremium(user_id, prize);
                break;
                
            case 'stars':
                // –î–æ–±–∞–≤–ª—è–µ–º –∑–≤–µ–∑–¥—ã –Ω–∞ –±–∞–ª–∞–Ω—Å
                await addStarsToUser(user_id, prize.stars_value);
                break;
        }
        
        res.json(result);
    } catch (error) {
        res.status(500).json({ error: 'Failed to claim prize' });
    }
});

// –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–æ–¥–∞—Ä–∫–∞ —á–µ—Ä–µ–∑ Telegram
async function sendTelegramGift(userId, prize) {
    const response = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendGift`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
            chat_id: userId,
            gift_id: prize.telegram_gift_id,
            message_thread_id: null
        })
    });
    
    const data = await response.json();
    return data.result?.message_id;
}

// –ê–∫—Ç–∏–≤–∞—Ü–∏—è –ø—Ä–µ–º–∏—É–º –ø–æ–¥–ø–∏—Å–∫–∏
async function activatePremium(userId, prize) {
    const response = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/setChatMember`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
            chat_id: userId,
            user_id: userId,
            until_date: Math.floor(Date.now() / 1000) + (prize.premium_duration * 24 * 60 * 60)
        })
    });
    
    const data = await response.json();
    return data.result?.subscription_id;
}

app.listen(3000, () => {
    console.log('Server running on port 3000');
});
```

### 3.2 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
npm init -y
npm install express cors crypto
```

## üóÑÔ∏è –®–∞–≥ 4: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### 4.1 MongoDB (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```javascript
const mongoose = require('mongoose');

const userSchema = new mongoose.Schema({
    user_id: { type: Number, required: true, unique: true },
    username: String,
    first_name: String,
    stars_balance: { type: Number, default: 0 },
    inventory: [{
        type: String,
        name: String,
        icon: String,
        description: String,
        rarity: String,
        claimed_at: { type: Date, default: Date.now }
    }],
    created_at: { type: Date, default: Date.now },
    updated_at: { type: Date, default: Date.now }
});

const User = mongoose.model('User', userSchema);

// –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
async function saveUserData(userId, data) {
    await User.findOneAndUpdate(
        { user_id: userId },
        { 
            ...data, 
            updated_at: new Date() 
        },
        { upsert: true, new: true }
    );
}

async function getUserData(userId) {
    return await User.findOne({ user_id: userId });
}
```

## üîß –®–∞–≥ 5: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π

### 5.1 –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π –∑–≤–µ–∑–¥–∞–º–∏

```javascript
// Webhook –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π
app.post('/webhook/payment', async (req, res) => {
    try {
        const { payment } = req.body;
        
        if (payment.status === 'completed') {
            const payload = JSON.parse(payment.invoice_payload);
            
            if (payload.type === 'stars_purchase') {
                const starsAmount = parseInt(payment.total_amount) / 100;
                await addStarsToUser(payload.user_id, starsAmount);
                
                // –£–≤–µ–¥–æ–º–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                await sendMessage(payload.user_id, 
                    `‚úÖ –ü–æ–ª—É—á–µ–Ω–æ ${starsAmount} –∑–≤–µ–∑–¥! –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å –∫–µ–π—Å—ã!`
                );
            }
        }
        
        res.json({ ok: true });
    } catch (error) {
        console.error('Payment webhook error:', error);
        res.status(500).json({ error: 'Webhook error' });
    }
});

// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–≤–µ–∑–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
async function addStarsToUser(userId, amount) {
    await User.findOneAndUpdate(
        { user_id: userId },
        { $inc: { stars_balance: amount } },
        { upsert: true }
    );
}
```

## üåê –®–∞–≥ 6: –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### 6.1 GitHub Pages (–¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞)

1. –°–æ–∑–¥–∞–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub
2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
3. –í–∫–ª—é—á–∏—Ç–µ GitHub Pages –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
4. –ü–æ–ª—É—á–∏—Ç–µ URL: `https://username.github.io/repository-name`

### 6.2 Heroku (–¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞)

1. –°–æ–∑–¥–∞–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç –Ω–∞ [Heroku](https://heroku.com)
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Heroku CLI
3. –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
```bash
heroku create your-case-master-api
git add .
git commit -m "Initial commit"
git push heroku main
```

### 6.3 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
heroku config:set BOT_TOKEN=your_bot_token
heroku config:set MONGODB_URI=your_mongodb_connection_string
heroku config:set WEBHOOK_SECRET=your_webhook_secret
```

## üîó –®–∞–≥ 7: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Webhook

### 7.1 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Webhook –¥–ª—è –ø–ª–∞—Ç–µ–∂–µ–π

```javascript
// –£—Å—Ç–∞–Ω–æ–≤–∫–∞ webhook
app.post('/setup-webhook', async (req, res) => {
    try {
        const webhookUrl = 'https://your-heroku-app.herokuapp.com/webhook/payment';
        
        const response = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/setWebhook`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                url: webhookUrl,
                secret_token: WEBHOOK_SECRET
            })
        });
        
        const data = await response.json();
        res.json(data);
    } catch (error) {
        res.status(500).json({ error: 'Failed to set webhook' });
    }
});
```

## üß™ –®–∞–≥ 8: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 8.1 –¢–µ—Å—Ç –≤ Telegram

1. –ù–∞–π–¥–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞ –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start`
3. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏

### 8.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤

```bash
heroku logs --tail
```

## üöÄ –®–∞–≥ 9: –ó–∞–ø—É—Å–∫ –≤ –ø—Ä–æ–¥–∞–∫—à–Ω

### 9.1 –§–∏–Ω–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

1. –û–±–Ω–æ–≤–∏—Ç–µ URL –≤ –º–∞–Ω–∏—Ñ–µ—Å—Ç–µ
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Å–µ API endpoints
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
4. –°–æ–∑–¥–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏

### 9.2 –ü—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ

1. –°–æ–∑–¥–∞–π—Ç–µ –∫–∞–Ω–∞–ª –¥–ª—è –±–æ—Ç–∞
2. –î–æ–±–∞–≤—å—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
3. –ü—Ä–∏–≥–ª–∞—Å–∏—Ç–µ –¥—Ä—É–∑–µ–π –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
4. –°–æ–±–µ—Ä–∏—Ç–µ –æ—Ç–∑—ã–≤—ã –∏ —É–ª—É—á—à–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞** - `heroku logs --tail`
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞** - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ URL** - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–µ–Ω
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö** - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å

## üéâ –ì–æ—Ç–æ–≤–æ!

–í–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∫ —Ä–∞–±–æ—Ç–µ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∑–≤–µ–∑–¥–∞–º–∏ Telegram! –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–º–æ–≥—É—Ç:

- –ü–æ–∫—É–ø–∞—Ç—å –∑–≤–µ–∑–¥—ã —á–µ—Ä–µ–∑ Telegram
- –û—Ç–∫—Ä—ã–≤–∞—Ç—å –∫–µ–π—Å—ã –∑–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –∑–≤–µ–∑–¥—ã
- –ü–æ–ª—É—á–∞—Ç—å –Ω–∞—Å—Ç–æ—è—â–∏–µ –ø–æ–¥–∞—Ä–∫–∏ –∏ –ø—Ä–µ–º–∏—É–º –ø–æ–¥–ø–∏—Å–∫–∏
- –ù–∞—Å–ª–∞–∂–¥–∞—Ç—å—Å—è –∫—Ä–∞—Å–∏–≤—ã–º–∏ –∞–Ω–∏–º–∞—Ü–∏—è–º–∏

–£–¥–∞—á–∏ —Å –≤–∞—à–∏–º –ø—Ä–æ–µ–∫—Ç–æ–º! üöÄ
